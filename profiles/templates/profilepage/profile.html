{% extends "base.html" %}
{% block title %}My Profile | UVA Leftovers{% endblock %}

{% block content %}
<div style="max-width: 700px; margin: 40px auto; padding: 0 16px;">

  <div style="
      background:#ffffff;
      border-radius:18px;
      box-shadow:0 4px 14px rgba(0,0,0,0.06);
      padding:32px 28px;
      text-align:center;
    ">

    <h1 style="margin-bottom:20px; color:#232D4B;">
      My Profile
    </h1>

    <!-- Avatar -->
    <div style="
        width:180px;
        height:180px;
        margin:0 auto 16px;
        border-radius:50%;
        overflow:hidden;
        border:3px solid #E57200;
        box-shadow:0 2px 8px rgba(0,0,0,0.08);
      ">
      <img src="{{ user.profile.avatar_url }}"
           style="width:100%; height:100%; object-fit:cover;" />
    </div>

    <!-- Display name & role -->
    <h2 style="margin-bottom:4px; font-size:1.6rem; color:#232D4B;">
      {{ profile.display_name }}
    </h2>
    <p style="margin:0 0 14px; color:#666; font-size:0.95rem;">
      {{ profile.get_role_display }}
    </p>

    <!-- Info List (email, major, bio...) -->
    <div style="text-align:left; margin: 0 auto; max-width: 420px;">

      <p style="margin-bottom:8px;">
        <strong>Email:</strong> {{ request.user.email }}
      </p>

      {% if profile.major %}
        <p style="margin-bottom:8px;">
          <strong>Major:</strong> {{ profile.major }}
        </p>
      {% endif %}

      {% if profile.bio %}
        <p style="margin-bottom:14px;">
          <strong>Bio:</strong><br>
          <span style="line-height:1.5;">{{ profile.bio }}</span>
        </p>
      {% endif %}

      {% if profile.preferences.all %}
        <p style="margin-top:16px;">
          <strong>Favorite Cuisines:</strong><br>
          {% for cuisine in profile.preferences.all %}
            <span style="
                display:inline-block;
                background:#E57200;
                color:white;
                padding:4px 12px;
                border-radius:999px;
                margin:3px;
                font-size:0.85rem;
              ">{{ cuisine.name }}</span>
          {% endfor %}
        </p>
      {% endif %}

      {% if profile.allergens.all %}
        <p style="margin-top:16px;">
          <strong>Allergens:</strong><br>
          {% for allergen in profile.allergens.all %}
            <span style="
                display:inline-block;
                background:#dc3545;
                color:white;
                padding:4px 12px;
                border-radius:999px;
                margin:3px;
                font-size:0.85rem;
              ">{{ allergen.name }}</span>
          {% endfor %}
        </p>
      {% endif %}
    </div>

    <!-- Buttons -->
    <div style="margin-top:24px; display:flex; flex-direction:column; gap:12px;">

      <a href="{% url 'profile_edit' %}"
         style="background:#E57200; color:white; padding:12px 18px;
                border-radius:999px; text-decoration:none; font-weight:600;">
        Edit Profile
      </a>

      <a href="{% url 'view_profile' request.user.id %}"
         style="background:white; color:#E57200; padding:12px 18px;
                border-radius:999px; border:1px solid #E57200;
                text-decoration:none; font-weight:600;">
        View Public Profile
      </a>

      {% if profile.role == "student" %}
        <a href="{% url 'userprivileges:student_home' %}"
           style="background:#232D4B; color:white; padding:12px 18px;
                  border-radius:999px; text-decoration:none; font-weight:600;">
          See Available Food
        </a>
      {% elif profile.role == "org" %}
        <a href="{% url 'userprivileges:provider_home' %}"
           style="background:#232D4B; color:white; padding:12px 18px;
                  border-radius:999px; text-decoration:none; font-weight:600;">
          Post Listings
        </a>
      {% endif %}

    </div>
  </div>

</div>
{% endblock %}
