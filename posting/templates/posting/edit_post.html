{% extends "base.html" %}
{% block content %}

<style>
  .event-edit-wrapper {
    max-width: 650px;
    margin: 40px auto;
    padding: 0 20px;
  }

  .event-edit-card {
    background: #ffffff;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    padding: 32px 28px;
  }

  .event-edit-title {
    font-size: 1.8rem;
    font-weight: 700;
    color: #232D4B;
    text-align: center;
    margin-bottom: 24px;
    border-bottom: 3px solid #E57200;
    padding-bottom: 12px;
  }

  .form-row {
    margin-bottom: 18px;
  }

  .form-label {
    display: block;
    font-weight: 600;
    font-size: 0.95rem;
    margin-bottom: 6px;
    color: #111827;
  }

  .form-row input[type="text"],
  .form-row input[type="number"],
  .form-row input[type="datetime-local"],
  .form-row input[type="date"],
  .form-row input[type="time"],
  .form-row input[type="email"],
  .form-row textarea,
  .form-row select {
    width: 100%;
    padding: 10px 12px;
    border-radius: 8px;
    border: 2px solid #e5e7eb;
    font-size: 0.95rem;
    box-sizing: border-box;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
  }

  .form-row textarea {
    min-height: 110px;
    resize: vertical;
  }

  .form-row input:focus,
  .form-row textarea:focus,
  .form-row select:focus {
    outline: none;
    border-color: #E57200;
    box-shadow: 0 0 0 3px rgba(229, 114, 0, 0.15);
  }

  .help-text {
    font-size: 0.8rem;
    color: #6b7280;
    margin-top: 4px;
  }

  .error-text {
    font-size: 0.8rem;
    color: #b91c1c;
    margin-top: 4px;
  }

  .current-image {
    margin-top: 10px;
    margin-bottom: 16px;
  }

  .current-image img {
    width: 100%;
    border-radius: 12px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.15);
  }

  .checkbox-inline {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 0.9rem;
    margin-top: 8px;
  }

  .button-row {
    margin-top: 24px;
    display: flex;
    gap: 10px;
    justify-content: flex-end;
  }

  .primary-button {
    background: #232D4B;
    color: #ffffff;
    padding: 10px 20px;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.95rem;
    box-shadow: 0 4px 10px rgba(35,45,75,0.3);
    transition: all 0.2s ease;
  }

  .primary-button:hover {
    background: #1b2238;
    transform: translateY(-1px);
  }

  .secondary-link {
    padding: 10px 16px;
    border-radius: 10px;
    border: 1px solid #e5e7eb;
    text-decoration: none;
    font-size: 0.9rem;
    color: #4b5563;
    background: #f9fafb;
    transition: all 0.2s ease;
  }

  .secondary-link:hover {
    background: #f3f4f6;
    color: #111827;
  }
</style>

<div class="event-edit-wrapper">
  <div class="event-edit-card">
    <h2 class="event-edit-title">Edit Event</h2>

    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

      {# non-field errors #}
      {% if form.non_field_errors %}
        <div class="error-text" style="margin-bottom: 12px;">
          {{ form.non_field_errors }}
        </div>
      {% endif %}

      {# loop over each field for full control #}
      {% for field in form %}
        <div class="form-row">
          <label for="{{ field.id_for_label }}" class="form-label">
            {{ field.label }}
            {% if field.field.required %}<span style="color:#DC2626;">*</span>{% endif %}
          </label>
          {{ field }}

          {% if field.help_text %}
            <div class="help-text">{{ field.help_text }}</div>
          {% endif %}

          {% if field.errors %}
            <div class="error-text">{{ field.errors }}</div>
          {% endif %}
        </div>
      {% endfor %}

      <!-- Current image (if exists) -->
{% if post.image %}
  <div class="current-image">
    <img id="imagePreview" src="{{ post.image.url }}" alt="Event Image"
         style="width:100%; border-radius:12px;">
  </div>

{% endif %}

<!-- Custom button -->
<button type="button" class="primary-button" id="triggerUpload">
  ðŸ“¸ Change Event Image
</button>

<!-- Hidden real field -->
{{ form.image }}

<!-- Optional: Remove image -->
{% if post.image %}
  <label class="checkbox-inline">
    <input type="checkbox" name="remove"> Remove this image
  </label>
{% endif %}


      <div class="button-row">
        <a href="{% url 'posting:post_detail' post.id %}" class="secondary-link">
          Cancel
        </a>
        <button type="submit" class="primary-button">
          Save Changes
        </button>
      </div>
    </form>
  </div>
</div>


<script>
  const realInput = document.getElementById('imageInput');
  const preview = document.getElementById('imagePreview');
  const trigger = document.getElementById('triggerUpload');

  trigger.addEventListener('click', () => realInput.click());

  realInput.addEventListener('change', (e) => {
    const [file] = e.target.files || [];
    if (file) preview.src = URL.createObjectURL(file);
  });
</script>

{% endblock %}



